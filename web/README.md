# 定投+做T策略可视化Web UI

## 功能特性

### 1. K线图展示
- 支持滚动查看历史数据
- 显示OHLCV（开盘价、最高价、最低价、收盘价、成交量）
- 支持缩放和平移操作
- 鼠标悬停显示详细信息

### 2. 买入卖出点标记
- 红色三角形：卖出点
- 绿色三角形：买入点
- 显示交易策略类型（定投/做T）
- 显示交易数量和盈亏信息

### 3. 技术指标显示
- **MACD指标**：MACD线、信号线、上轨、下轨
- **成交量比率**：当前成交量/20日均线
- **ATR比率**：ATR/价格
- **估值状态**：高估/低估/合理
- **交易信号**：加仓/减仓/无信号

### 4. 回测结果展示
- 总收益率
- 年化收益率
- 最大回撤
- 夏普比率
- 最终资产
- 定投买入/卖出次数
- 做T买入/卖出次数
- 做T盈亏

### 5. 标的选择器
- 支持12个ETF标的
- 点击卡片切换查看不同标的的数据
- 实时更新图表和指标

## 使用方法

### 启动服务

```bash
cd /Users/sigma/Documents/myproject/quant-bigA
python3 web/app.py
```

服务启动后，访问：http://localhost:5001

### 支持的标的

| 代码 | 名称 | 类型 |
|------|------|------|
| 510300.SH | 沪深300ETF | ETF |
| 510500.SH | 中证500ETF | ETF |
| 159915.SZ | 创业板ETF | ETF |
| 512880.SH | 证券ETF | ETF |
| 512690.SH | 酒ETF | ETF |
| 159928.SZ | 消费ETF | ETF |
| 512100.SH | 中证1000ETF | ETF |
| 512000.SH | 券商ETF | ETF |
| 516160.SH | 新能源车ETF | ETF |
| 515050.SH | 5GETF | ETF |
| 159806.SZ | 新能源ETF | ETF |
| 516970.SH | 红利低波ETF | ETF |

## 技术架构

### 后端
- **框架**：Flask
- **数据源**：本地CSV文件
- **技术指标计算**：strategies/indicators.py
- **数据获取**：utils/data_fetcher.py

### 前端
- **图表库**：ECharts 5.4.3
- **UI框架**：原生HTML/CSS/JavaScript
- **响应式设计**：支持不同屏幕尺寸

### API接口

#### 获取标的列表
```
GET /api/symbols
```

#### 获取回测结果
```
GET /api/results/<symbol>
```

#### 获取K线图数据
```
GET /api/chart/<symbol>
```

#### 获取交易数据
```
GET /api/trades/<symbol>
```

#### 获取技术指标数据
```
GET /api/indicators/<symbol>
```

#### 获取所有标的汇总
```
GET /api/summary
```

## 文件结构

```
web/
├── app.py                 # Flask应用主文件
├── templates/
│   └── index.html        # 前端页面
└── static/               # 静态资源目录
```

## 注意事项

1. **端口冲突**：如果5001端口被占用，可以在app.py中修改端口号
2. **数据依赖**：需要先运行回测生成数据文件
3. **性能优化**：当前使用开发服务器，生产环境建议使用WSGI服务器
4. **浏览器兼容性**：建议使用Chrome、Firefox、Edge等现代浏览器

## 常见问题

### Q: 页面无法加载？
A: 检查Flask服务是否正常启动，确保端口5001未被占用

### Q: K线图显示空白？
A: 检查是否有对应标的的数据文件，确保回测已成功运行

### Q: 买卖点不显示？
A: 检查trades.csv文件是否存在且格式正确

### Q: 技术指标不更新？
A: 刷新页面或检查浏览器控制台是否有错误信息

## 扩展功能建议

1. **实时数据**：接入实时行情API
2. **多策略对比**：同时显示多个策略的回测结果
3. **参数调优**：在页面上直接调整策略参数
4. **导出功能**：导出回测报告为PDF或Excel
5. **移动端适配**：优化移动端显示效果
6. **用户系统**：支持多用户登录和数据隔离

---

**免责声明**：本工具仅用于历史数据回测和可视化展示，不构成投资建议。实际投资请谨慎决策。